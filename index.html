<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Form Kontak Modern</title>

<style>
body {
  font-family: 'Segoe UI', sans-serif;
  background: linear-gradient(135deg, #4e73df, #1cc88a);
  display: flex;
  justify-content: center;
  align-items: center;
  height: 100vh;
  margin: 0;
}

.card {
  background: white;
  padding: 30px;
  border-radius: 15px;
  width: 100%;
  max-width: 400px;
  box-shadow: 0 15px 40px rgba(0,0,0,0.2);
  animation: fadeIn 0.6s ease-in-out;
}

h2 {
  text-align: center;
  margin-bottom: 20px;
}

input, textarea {
  width: 100%;
  padding: 12px;
  margin-bottom: 15px;
  border-radius: 8px;
  border: 1px solid #ddd;
  font-size: 14px;
  transition: 0.3s;
}

input:focus, textarea:focus {
  border-color: #4e73df;
  outline: none;
  box-shadow: 0 0 5px rgba(78,115,223,0.4);
}

button {
  width: 100%;
  padding: 12px;
  border: none;
  border-radius: 8px;
  background: #4e73df;
  color: white;
  font-size: 16px;
  cursor: pointer;
  transition: 0.3s;
  position: relative;
}

button:hover {
  background: #2e59d9;
}

button:disabled {
  background: #999;
  cursor: not-allowed;
}

.spinner {
  border: 3px solid #f3f3f3;
  border-top: 3px solid white;
  border-radius: 50%;
  width: 18px;
  height: 18px;
  animation: spin 1s linear infinite;
  position: absolute;
  right: 15px;
  top: 50%;
  transform: translateY(-50%);
  display: none;
}

.success {
  background: #d4edda;
  color: #155724;
  padding: 10px;
  border-radius: 8px;
  text-align: center;
  margin-top: 10px;
  display: none;
}

.error {
  background: #f8d7da;
  color: #721c24;
  padding: 10px;
  border-radius: 8px;
  text-align: center;
  margin-top: 10px;
  display: none;
}

@keyframes spin {
  0% { transform: translateY(-50%) rotate(0deg); }
  100% { transform: translateY(-50%) rotate(360deg); }
}

@keyframes fadeIn {
  from { opacity: 0; transform: translateY(15px); }
  to { opacity: 1; transform: translateY(0); }
}
</style>
</head>
<body>

<div class="card">
  <h2>Form Kontak</h2>

  <form id="myForm">
    <input type="text" name="nama" placeholder="Nama Lengkap" required>
    <select name="ranting" id="rantingSelect" required>
  <option value="">Memuat data ranting...</option>
</select>

    <textarea name="pesan" placeholder="Tulis pesan..." rows="4" required></textarea>

    <button type="submit" id="submitBtn">
      Kirim
      <div class="spinner" id="spinner"></div>
    </button>
  </form>

  <div class="success" id="successMsg">
    ✅ Data berhasil dikirim!
  </div>

  <div class="error" id="errorMsg">
    ❌ Terjadi kesalahan, coba lagi.
  </div>
</div>

<script>
const scriptURL = "https://script.google.com/macros/s/AKfycbzjDJAttqnocj7nC93mKqRBI5bt7MgT4lRb87Q7b2rF7HqlFtMQlA8uKZwofy-LpmhMug/exec";

const form = document.getElementById("myForm");
const button = document.getElementById("submitBtn");
const spinner = document.getElementById("spinner");
const successMsg = document.getElementById("successMsg");
const errorMsg = document.getElementById("errorMsg");
const rantingSelect = document.getElementById("rantingSelect");

/* ===============================
   LOAD DROPDOWN DARI SHEET
=================================*/

fetch(scriptURL)
  .then(res => res.json())
  .then(data => {
    rantingSelect.innerHTML = '<option value="">Pilih Ranting</option>';
    data.forEach(ranting => {
      let option = document.createElement("option");
      option.value = ranting;
      option.textContent = ranting;
      rantingSelect.appendChild(option);
    });
  })
  .catch(() => {
    rantingSelect.innerHTML = '<option value="">Gagal memuat data</option>';
  });

/* ===============================
   SUBMIT FORM
=================================*/

form.addEventListener("submit", function(e) {
  e.preventDefault();

  successMsg.style.display = "none";
  errorMsg.style.display = "none";

  button.disabled = true;
  spinner.style.display = "block";

  const formData = new FormData(form);
  const data = Object.fromEntries(formData.entries());

  fetch(scriptURL, {
    method: "POST",
    body: JSON.stringify(data)
  })
  .then(res => res.json())
  .then(response => {
    successMsg.style.display = "block";
    form.reset();
  })
  .catch(error => {
    errorMsg.style.display = "block";
  })
  .finally(() => {
    button.disabled = false;
    spinner.style.display = "none";
  });
});
</script>


</body>
</html>
